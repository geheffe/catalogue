<script>
document.addEventListener('DOMContentLoaded', function() {
    const hamburger = document.querySelector('.hamburger-menu');
    const menu = document.querySelector('.site-menu');
    // Gestion de la croix
    const closeBtn = document.querySelector('.close-menu');
    
    hamburger.addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.toggle('show');
    });
    
    document.addEventListener('click', function() {
        menu.classList.remove('show');
    });
    
    menu.addEventListener('click', function(e) {
        e.stopPropagation();
    });
    
    // Ouvre le menu + montre la croix
    document.querySelector('.hamburger-menu').addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.add('show');
        closeBtn.style.display = 'block';
    });

    // Ferme le menu + cache la croix
    closeBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.remove('show');
        this.style.display = 'none';
    });

    // Fermeture en cliquant ailleurs
    document.addEventListener('click', function(e) {
        if (!menu.contains(e.target) && e.target !== closeBtn) {
            menu.classList.remove('show');
            closeBtn.style.display = 'none';
        }
    });
    
});

// Version simplifiée et garantie
function setupMenu() {
    // 1. Gestion du menu hamburger
    const hamburger = document.querySelector('.hamburger-menu');
    const menu = document.querySelector('.site-menu');
    
    if (!hamburger || !menu) return; // Sécurité

    hamburger.addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.toggle('show');
    });

    document.querySelectorAll('.site-menu li.has-submenu').forEach(item => {
    const link = item.querySelector('a');
 
    
    link.addEventListener('click', function(e) {
        if (window.innerWidth <= 768) {
            e.preventDefault();
            const submenu = item.querySelector('.submenu');
            const isOpen = submenu.classList.contains('mobile-show');
            
            // Ferme tous les sous-menus
            document.querySelectorAll('.submenu').forEach(s => s.classList.remove('mobile-show'));
            
            // Ouvre/ferme seulement si c'était fermé
            if (!isOpen) {
                submenu.classList.add('mobile-show');
                item.classList.add('opened');
            } else {
                item.classList.remove('opened');
            }
        }
    });
    
        
});

    // 3. Fermeture au clic extérieur
    document.addEventListener('click', function() {
        menu.classList.remove('show');
        document.querySelectorAll('.submenu').forEach(s => s.classList.remove('show'));
    });
}

// Double sécurité
document.addEventListener('DOMContentLoaded', setupMenu);
window.addEventListener('load', setupMenu);


</script>
