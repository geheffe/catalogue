<script>
document.addEventListener('DOMContentLoaded', function() {
    const hamburger = document.querySelector('.hamburger-menu');
    const menu = document.querySelector('.site-menu');
    // Gestion de la croix
    const closeBtn = document.querySelector('.close-menu');
    
    hamburger.addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.toggle('show');
    });
    
    document.addEventListener('click', function() {
        menu.classList.remove('show');
    });
    
    menu.addEventListener('click', function(e) {
        e.stopPropagation();
    });
    
    // Ouvre le menu + montre la croix
    document.querySelector('.hamburger-menu').addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.add('show');
        closeBtn.style.display = 'block';
    });

    // Ferme le menu + cache la croix
    closeBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.remove('show');
        this.style.display = 'none';
    });

    // Fermeture en cliquant ailleurs
    document.addEventListener('click', function(e) {
        if (!menu.contains(e.target) && e.target !== closeBtn) {
            menu.classList.remove('show');
            closeBtn.style.display = 'none';
        }
    });
    
});

// Version simplifiée et garantie
function setupMenu() {
    // 1. Gestion du menu hamburger
    const hamburger = document.querySelector('.hamburger-menu');
    const menu = document.querySelector('.site-menu');
    
    if (!hamburger || !menu) return; // Sécurité

    hamburger.addEventListener('click', function(e) {
        e.stopPropagation();
        menu.classList.toggle('show');
    });

    document.querySelectorAll('.site-menu li.has-submenu').forEach(item => {
    const link = item.querySelector('a');
    const submenu = item.querySelector('.submenu');
    
    link.addEventListener('click', function(e) {
        if (window.innerWidth <= 768) {
            e.preventDefault();
            const isOpen = item.classList.contains('opened');
            
            // Ferme tous les autres sous-menus
            document.querySelectorAll('.site-menu li.has-submenu').forEach(otherItem => {
                if (otherItem !== item) {
                    otherItem.classList.remove('opened');
                    otherItem.querySelector('.submenu').classList.remove('mobile-show');
                }
            });
            
            // Toggle le sous-menu actuel
            item.classList.toggle('opened', !isOpen);
            submenu.classList.toggle('mobile-show', !isOpen);
          }
       });
    });

    // 3. Fermeture au clic extérieur
    document.addEventListener('click', function() {
        menu.classList.remove('show');
        document.querySelectorAll('.submenu').forEach(s => s.classList.remove('show'));
    });
}

// Double sécurité
document.addEventListener('DOMContentLoaded', setupMenu);
window.addEventListener('load', setupMenu);


</script>
